# Development Guidelines

## Agent 策略

| Agent | 用途 | 触发场景 |
|-------|------|----------|
| **knowledge-scout** | 知识收集 | 调研技术概念、最佳实践、外部信息 |
| **code-scout** | 代码分析 | 探索代码结构、查找模式、追踪依赖 |

**使用原则**:
- 需要外部知识 → `knowledge-scout`（优先查缓存，必要时搜索）
- 需要分析代码 → `code-scout`（并行搜索，file:line 引用）
- 两者可并行运行以提高效率

## 核心原则

- **增量进展** - 小步提交，保持可编译
- **先学后做** - 研究现有代码再实现
- **简单优先** - 选择无聊但有效的方案
- **单一职责** - 每个函数/类只做一件事

## 开发流程

### 复杂任务分阶段

在 `IMPLEMENTATION_PLAN.md` 中记录（完成后删除）：
```
## Stage N: [名称]
目标: [具体交付物]
状态: [Not Started|In Progress|Complete]
```

### 实现顺序

1. **理解** - 找 3 个相似实现学习
2. **测试** - 先写测试 (red)
3. **实现** - 最小代码通过 (green)
4. **重构** - 保持测试通过
5. **提交** - 说明 "为什么"

### 卡住时 (3 次尝试后 STOP)

1. 记录失败原因和错误信息
2. 用 `knowledge-scout` 调研替代方案
3. 质疑：是否正确的抽象层级？能否拆分？
4. 换角度：不同库/模式/更简单的方法？

## 代码标准

**架构**: 组合优于继承 | 接口优于单例 | 显式优于隐式

**质量门禁**:
- [ ] 测试通过
- [ ] 无 linter 警告
- [ ] commit message 清晰
- [ ] 无无 issue 的 TODO

**错误处理**: 快速失败 + 上下文信息 | 绝不静默吞异常

## Token 效率

**每次任务**:
- 任务间用 `/clear` 重置上下文
- 70% 容量时用 `/compact`
- 用 `@file` 精确引用，避免泛泛描述

**避免**:
- 过度工程
- 不必要的抽象
- 没被要求的功能

## 禁止事项

- `--no-verify` 绕过 hooks
- 禁用测试而非修复
- 提交不能编译的代码
- 假设而非验证
